

```python
!rm hawaii.sqlite
```


```python
import pandas as pd
import numpy as np
from sqlalchemy import create_engine, MetaData
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import Session
from sqlalchemy.ext.automap import automap_base
import pymysql
pymysql.install_as_MySQLdb()
Base = declarative_base()
```


```python
import sqlalchemy
import pandas as pd
from sqlalchemy import create_engine, MetaData
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import Column, Integer, String, Numeric, Text, Float, DateTime
import datetime as dt
```


```python
class Data(Base):
    __tablename__ = "Hawaii"
    #properties

    id = Column(Integer, primary_key=True)
    station = Column(String)
    name = Column(String)
    latitude = Column(Float)
    longitude = Column(Float)
    elevation = Column(Integer)
    prcp = Column(Float)
    tobs = Column(Integer)
    date = Column(Text)

    
    #return a printed copy of objects id and name  
    def __repr__(self):
        return f"id={self.id}, name={self.name}"
```


```python
Base.metadata.create_all(engine)
session = Session(bind=engine)

data = pd.read_csv('datafile.csv') 
data.head()
```




<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>station</th>
      <th>date</th>
      <th>prcp</th>
      <th>tobs</th>
      <th>name</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>elevation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>USC00519397</td>
      <td>2010-01-01</td>
      <td>0.08</td>
      <td>65</td>
      <td>WAIKIKI 717.2, HI US</td>
      <td>21.2716</td>
      <td>-157.8168</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>USC00519397</td>
      <td>2010-01-02</td>
      <td>0.00</td>
      <td>63</td>
      <td>WAIKIKI 717.2, HI US</td>
      <td>21.2716</td>
      <td>-157.8168</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>USC00519397</td>
      <td>2010-01-03</td>
      <td>0.00</td>
      <td>74</td>
      <td>WAIKIKI 717.2, HI US</td>
      <td>21.2716</td>
      <td>-157.8168</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>USC00519397</td>
      <td>2010-01-04</td>
      <td>0.00</td>
      <td>76</td>
      <td>WAIKIKI 717.2, HI US</td>
      <td>21.2716</td>
      <td>-157.8168</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>USC00519397</td>
      <td>2010-01-06</td>
      <td>NaN</td>
      <td>73</td>
      <td>WAIKIKI 717.2, HI US</td>
      <td>21.2716</td>
      <td>-157.8168</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Use MetaData from SQLAlchemy to reflect the tables
metadata = MetaData(bind=engine)
metadata.reflect()


table = sqlalchemy.Table('Hawaii', metadata, autoload=True)
 # Use `table.delete()` to remove any pre-existing data.
# Note that this is a convenience function so that you can re-run the example code multiple times.
# You would not likely do this step in production.
# conn.execute(table.delete())
```


```python
# Use Orient='records' to create a list of data to write
# to_dict() cleans out DataFrame metadata as well
# http://pandas-docs.github.io/pandas-docs-travis/io.html#orient-options
data_dict = data.to_dict(orient="records")
data_dict[:5]
```




    [{'date': '2010-01-01',
      'elevation': 3.0,
      'latitude': 21.2716,
      'longitude': -157.8168,
      'name': 'WAIKIKI 717.2, HI US',
      'prcp': 0.08,
      'station': 'USC00519397',
      'tobs': 65},
     {'date': '2010-01-02',
      'elevation': 3.0,
      'latitude': 21.2716,
      'longitude': -157.8168,
      'name': 'WAIKIKI 717.2, HI US',
      'prcp': 0.0,
      'station': 'USC00519397',
      'tobs': 63},
     {'date': '2010-01-03',
      'elevation': 3.0,
      'latitude': 21.2716,
      'longitude': -157.8168,
      'name': 'WAIKIKI 717.2, HI US',
      'prcp': 0.0,
      'station': 'USC00519397',
      'tobs': 74},
     {'date': '2010-01-04',
      'elevation': 3.0,
      'latitude': 21.2716,
      'longitude': -157.8168,
      'name': 'WAIKIKI 717.2, HI US',
      'prcp': 0.0,
      'station': 'USC00519397',
      'tobs': 76},
     {'date': '2010-01-06',
      'elevation': 3.0,
      'latitude': 21.2716,
      'longitude': -157.8168,
      'name': 'WAIKIKI 717.2, HI US',
      'prcp': nan,
      'station': 'USC00519397',
      'tobs': 73}]




```python
 # Use `table.insert()` to insert the data into the table
# The SQL table is populated during this step
conn.execute(table.insert(), data_dict)
```




    <sqlalchemy.engine.result.ResultProxy at 0x111535e48>




```python
engine = create_engine("sqlite:///hawaii.sqlite")

conn = engine.connect()
Base = automap_base()
Base.prepare(engine, reflect=True)
Base.classes.keys()
```




    ['Hawaii']




```python
Hawaii = Base.classes.Hawaii
```


```python


```


```python
# Test that the insert works by fetching the first 5 rows. 
conn.execute("select * from Hawaii limit 5").fetchall() 
```




    [(1, 'USC00519397', 'WAIKIKI 717.2, HI US', 21.2716, -157.8168, 3, 0.08, 65, '2010-01-01'),
     (2, 'USC00519397', 'WAIKIKI 717.2, HI US', 21.2716, -157.8168, 3, 0.0, 63, '2010-01-02'),
     (3, 'USC00519397', 'WAIKIKI 717.2, HI US', 21.2716, -157.8168, 3, 0.0, 74, '2010-01-03'),
     (4, 'USC00519397', 'WAIKIKI 717.2, HI US', 21.2716, -157.8168, 3, 0.0, 76, '2010-01-04'),
     (5, 'USC00519397', 'WAIKIKI 717.2, HI US', 21.2716, -157.8168, 3, None, 73, '2010-01-06')]




```python
last_year = dt.date.today() - dt.timedelta(days=365)
```


```python
# conn.execute(Hawaii.date).filter(max(Hawaii.date)).fetchall()

session.query(Hawaii.prcp,Hawaii.date).all()
```




    [(0.08, '2010-01-01'),
     (0.0, '2010-01-02'),
     (0.0, '2010-01-03'),
     (0.0, '2010-01-04'),
     (None, '2010-01-06'),
     (0.06, '2010-01-07'),
     (0.0, '2010-01-08'),
     (0.0, '2010-01-09'),
     (0.0, '2010-01-10'),
     (0.01, '2010-01-11'),
     (0.0, '2010-01-12'),
     (0.0, '2010-01-14'),
     (0.0, '2010-01-15'),
     (0.0, '2010-01-16'),
     (0.0, '2010-01-17'),
     (0.0, '2010-01-18'),
     (0.0, '2010-01-19'),
     (0.0, '2010-01-20'),
     (0.0, '2010-01-21'),
     (0.0, '2010-01-22'),
     (0.0, '2010-01-23'),
     (0.01, '2010-01-24'),
     (0.0, '2010-01-25'),
     (0.04, '2010-01-26'),
     (0.12, '2010-01-27'),
     (0.0, '2010-01-28'),
     (None, '2010-01-30'),
     (0.03, '2010-01-31'),
     (0.01, '2010-02-01'),
     (None, '2010-02-03'),
     (0.01, '2010-02-04'),
     (0.0, '2010-02-05'),
     (0.0, '2010-02-06'),
     (0.0, '2010-02-07'),
     (0.0, '2010-02-08'),
     (0.0, '2010-02-09'),
     (0.0, '2010-02-11'),
     (0.02, '2010-02-12'),
     (0.01, '2010-02-13'),
     (0.0, '2010-02-14'),
     (0.0, '2010-02-15'),
     (0.0, '2010-02-16'),
     (0.0, '2010-02-17'),
     (None, '2010-02-19'),
     (0.03, '2010-02-20'),
     (0.0, '2010-02-21'),
     (0.0, '2010-02-22'),
     (0.0, '2010-02-23'),
     (0.0, '2010-02-24'),
     (0.0, '2010-02-25'),
     (0.0, '2010-02-26'),
     (0.0, '2010-02-28'),
     (0.01, '2010-03-01'),
     (0.0, '2010-03-02'),
     (0.0, '2010-03-03'),
     (0.12, '2010-03-04'),
     (0.08, '2010-03-05'),
     (0.03, '2010-03-06'),
     (0.0, '2010-03-07'),
     (0.43, '2010-03-08'),
     (0.06, '2010-03-09'),
     (None, '2010-03-11'),
     (0.0, '2010-03-12'),
     (0.0, '2010-03-13'),
     (0.0, '2010-03-14'),
     (0.06, '2010-03-15'),
     (0.0, '2010-03-17'),
     (0.0, '2010-03-18'),
     (0.0, '2010-03-21'),
     (0.0, '2010-03-22'),
     (0.0, '2010-03-23'),
     (0.0, '2010-03-24'),
     (None, '2010-03-26'),
     (0.0, '2010-03-27'),
     (0.0, '2010-03-28'),
     (0.0, '2010-03-29'),
     (0.0, '2010-03-30'),
     (0.0, '2010-03-31'),
     (0.0, '2010-04-01'),
     (0.01, '2010-04-02'),
     (0.17, '2010-04-03'),
     (0.15, '2010-04-04'),
     (0.27, '2010-04-05'),
     (0.01, '2010-04-06'),
     (0.0, '2010-04-08'),
     (0.01, '2010-04-09'),
     (0.0, '2010-04-10'),
     (0.01, '2010-04-11'),
     (0.01, '2010-04-12'),
     (0.0, '2010-04-13'),
     (0.0, '2010-04-15'),
     (0.01, '2010-04-16'),
     (0.0, '2010-04-17'),
     (0.0, '2010-04-18'),
     (0.0, '2010-04-19'),
     (0.04, '2010-04-20'),
     (0.01, '2010-04-21'),
     (0.0, '2010-04-22'),
     (0.02, '2010-04-23'),
     (0.0, '2010-04-24'),
     (0.0, '2010-04-25'),
     (0.0, '2010-04-26'),
     (0.0, '2010-04-28'),
     (0.0, '2010-04-30'),
     (0.0, '2010-05-01'),
     (0.03, '2010-05-02'),
     (0.2, '2010-05-03'),
     (0.08, '2010-05-04'),
     (0.01, '2010-05-05'),
     (0.0, '2010-05-06'),
     (0.05, '2010-05-07'),
     (0.0, '2010-05-08'),
     (0.0, '2010-05-09'),
     (0.0, '2010-05-10'),
     (0.0, '2010-05-11'),
     (0.0, '2010-05-13'),
     (0.0, '2010-05-14'),
     (0.0, '2010-05-15'),
     (0.03, '2010-05-16'),
     (0.0, '2010-05-17'),
     (0.0, '2010-05-18'),
     (0.0, '2010-05-19'),
     (None, '2010-05-21'),
     (0.0, '2010-05-22'),
     (0.05, '2010-05-23'),
     (0.0, '2010-05-24'),
     (0.0, '2010-05-25'),
     (0.02, '2010-05-26'),
     (0.0, '2010-05-27'),
     (0.0, '2010-05-28'),
     (0.0, '2010-05-29'),
     (0.0, '2010-05-30'),
     (0.0, '2010-05-31'),
     (0.0, '2010-06-01'),
     (0.01, '2010-06-02'),
     (0.0, '2010-06-03'),
     (0.0, '2010-06-04'),
     (0.0, '2010-06-05'),
     (0.0, '2010-06-06'),
     (0.0, '2010-06-07'),
     (0.0, '2010-06-08'),
     (0.0, '2010-06-09'),
     (0.0, '2010-06-10'),
     (0.0, '2010-06-11'),
     (0.0, '2010-06-12'),
     (0.0, '2010-06-13'),
     (0.0, '2010-06-14'),
     (0.0, '2010-06-15'),
     (0.0, '2010-06-16'),
     (0.0, '2010-06-17'),
     (0.0, '2010-06-18'),
     (0.0, '2010-06-19'),
     (0.0, '2010-06-20'),
     (0.0, '2010-06-21'),
     (0.0, '2010-06-22'),
     (0.0, '2010-06-23'),
     (0.0, '2010-06-24'),
     (0.0, '2010-06-25'),
     (0.02, '2010-06-26'),
     (0.0, '2010-06-27'),
     (0.0, '2010-06-28'),
     (0.0, '2010-06-29'),
     (0.0, '2010-06-30'),
     (0.01, '2010-07-01'),
     (0.05, '2010-07-02'),
     (0.09, '2010-07-03'),
     (0.05, '2010-07-04'),
     (0.06, '2010-07-05'),
     (0.08, '2010-07-06'),
     (0.08, '2010-07-07'),
     (0.03, '2010-07-08'),
     (0.06, '2010-07-09'),
     (0.09, '2010-07-10'),
     (0.0, '2010-07-11'),
     (0.0, '2010-07-12'),
     (0.0, '2010-07-13'),
     (None, '2010-07-16'),
     (0.02, '2010-07-17'),
     (0.0, '2010-07-18'),
     (0.04, '2010-07-19'),
     (0.0, '2010-07-21'),
     (0.0, '2010-07-22'),
     (0.0, '2010-07-24'),
     (0.0, '2010-07-25'),
     (0.0, '2010-07-26'),
     (0.0, '2010-07-27'),
     (0.0, '2010-07-28'),
     (0.0, '2010-07-29'),
     (0.0, '2010-07-30'),
     (0.02, '2010-07-31'),
     (0.04, '2010-08-01'),
     (0.01, '2010-08-02'),
     (0.02, '2010-08-03'),
     (0.07, '2010-08-04'),
     (0.08, '2010-08-05'),
     (0.03, '2010-08-06'),
     (0.0, '2010-08-07'),
     (0.0, '2010-08-08'),
     (0.0, '2010-08-09'),
     (0.0, '2010-08-10'),
     (0.0, '2010-08-11'),
     (0.0, '2010-08-12'),
     (0.0, '2010-08-13'),
     (0.0, '2010-08-14'),
     (0.01, '2010-08-15'),
     (0.0, '2010-08-16'),
     (0.05, '2010-08-17'),
     (0.0, '2010-08-18'),
     (0.0, '2010-08-19'),
     (0.0, '2010-08-20'),
     (0.0, '2010-08-21'),
     (0.0, '2010-08-22'),
     (0.01, '2010-08-23'),
     (0.0, '2010-08-24'),
     (0.04, '2010-08-25'),
     (0.03, '2010-08-26'),
     (0.0, '2010-08-27'),
     (0.04, '2010-08-28'),
     (0.0, '2010-08-29'),
     (0.0, '2010-08-30'),
     (0.0, '2010-08-31'),
     (0.0, '2010-09-01'),
     (0.02, '2010-09-02'),
     (0.04, '2010-09-03'),
     (0.01, '2010-09-04'),
     (0.0, '2010-09-05'),
     (0.0, '2010-09-06'),
     (0.06, '2010-09-07'),
     (0.0, '2010-09-08'),
     (0.0, '2010-09-09'),
     (0.0, '2010-09-10'),
     (0.05, '2010-09-11'),
     (0.0, '2010-09-12'),
     (0.0, '2010-09-13'),
     (0.0, '2010-09-14'),
     (0.0, '2010-09-15'),
     (0.0, '2010-09-16'),
     (0.0, '2010-09-17'),
     (0.0, '2010-09-19'),
     (0.0, '2010-09-20'),
     (0.0, '2010-09-21'),
     (0.04, '2010-09-22'),
     (0.0, '2010-09-23'),
     (0.0, '2010-09-24'),
     (0.0, '2010-09-25'),
     (0.0, '2010-09-26'),
     (0.0, '2010-09-27'),
     (0.0, '2010-09-28'),
     (0.0, '2010-09-29'),
     (0.57, '2010-09-30'),
     (0.31, '2010-10-01'),
     (0.03, '2010-10-02'),
     (0.0, '2010-10-03'),
     (0.06, '2010-10-04'),
     (0.0, '2010-10-05'),
     (0.0, '2010-10-06'),
     (0.0, '2010-10-07'),
     (0.0, '2010-10-08'),
     (0.0, '2010-10-09'),
     (0.0, '2010-10-10'),
     (0.0, '2010-10-11'),
     (0.0, '2010-10-12'),
     (0.0, '2010-10-13'),
     (0.0, '2010-10-15'),
     (0.0, '2010-10-16'),
     (0.0, '2010-10-17'),
     (0.0, '2010-10-18'),
     (0.07, '2010-10-19'),
     (0.0, '2010-10-20'),
     (0.0, '2010-10-21'),
     (0.0, '2010-10-22'),
     (0.0, '2010-10-23'),
     (0.0, '2010-10-24'),
     (0.0, '2010-10-25'),
     (0.07, '2010-10-26'),
     (0.05, '2010-10-27'),
     (0.06, '2010-10-28'),
     (0.03, '2010-10-29'),
     (0.02, '2010-10-30'),
     (0.0, '2010-10-31'),
     (0.01, '2010-11-01'),
     (0.01, '2010-11-02'),
     (None, '2010-11-04'),
     (0.0, '2010-11-05'),
     (0.0, '2010-11-06'),
     (0.0, '2010-11-07'),
     (0.0, '2010-11-08'),
     (0.0, '2010-11-09'),
     (0.23, '2010-11-10'),
     (0.0, '2010-11-11'),
     (0.0, '2010-11-12'),
     (0.0, '2010-11-13'),
     (0.0, '2010-11-16'),
     (0.0, '2010-11-17'),
     (None, '2010-11-19'),
     (0.03, '2010-11-20'),
     (0.0, '2010-11-21'),
     (0.0, '2010-11-22'),
     (0.0, '2010-11-23'),
     (0.0, '2010-11-24'),
     (0.0, '2010-11-25'),
     (0.0, '2010-11-27'),
     (0.0, '2010-11-28'),
     (0.0, '2010-11-29'),
     (0.0, '2010-11-30'),
     (0.04, '2010-12-01'),
     (0.0, '2010-12-03'),
     (0.0, '2010-12-04'),
     (0.0, '2010-12-06'),
     (0.0, '2010-12-07'),
     (0.0, '2010-12-08'),
     (0.0, '2010-12-09'),
     (1.58, '2010-12-10'),
     (0.77, '2010-12-11'),
     (0.0, '2010-12-12'),
     (0.0, '2010-12-13'),
     (0.0, '2010-12-14'),
     (0.0, '2010-12-15'),
     (0.0, '2010-12-16'),
     (0.0, '2010-12-17'),
     (0.0, '2010-12-18'),
     (1.4, '2010-12-19'),
     (0.0, '2010-12-23'),
     (0.0, '2010-12-24'),
     (None, '2010-12-26'),
     (0.13, '2010-12-27'),
     (0.55, '2010-12-28'),
     (0.06, '2010-12-29'),
     (0.01, '2010-12-30'),
     (0.0, '2010-12-31'),
     (0.0, '2011-01-01'),
     (0.0, '2011-01-02'),
     (0.0, '2011-01-03'),
     (0.0, '2011-01-04'),
     (0.0, '2011-01-05'),
     (0.01, '2011-01-06'),
     (0.0, '2011-01-07'),
     (0.0, '2011-01-08'),
     (0.0, '2011-01-09'),
     (0.0, '2011-01-10'),
     (0.09, '2011-01-11'),
     (None, '2011-01-13'),
     (0.03, '2011-01-14'),
     (0.0, '2011-01-15'),
     (0.0, '2011-01-16'),
     (0.0, '2011-01-17'),
     (0.0, '2011-01-18'),
     (0.03, '2011-01-19'),
     (0.0, '2011-01-20'),
     (0.0, '2011-01-21'),
     (0.0, '2011-01-22'),
     (0.0, '2011-01-23'),
     (0.0, '2011-01-24'),
     (0.0, '2011-01-25'),
     (0.0, '2011-01-27'),
     (0.0, '2011-01-28'),
     (0.0, '2011-01-29'),
     (0.0, '2011-01-30'),
     (0.22, '2011-01-31'),
     (0.0, '2011-02-01'),
     (0.0, '2011-02-02'),
     (0.0, '2011-02-03'),
     (0.0, '2011-02-04'),
     (0.0, '2011-02-05'),
     (0.0, '2011-02-06'),
     (1.29, '2011-02-07'),
     (1.3, '2011-02-08'),
     (0.0, '2011-02-09'),
     (0.29, '2011-02-10'),
     (None, '2011-02-12'),
     (0.0, '2011-02-13'),
     (0.04, '2011-02-14'),
     (0.05, '2011-02-15'),
     (0.0, '2011-02-16'),
     (0.0, '2011-02-19'),
     (1.72, '2011-02-20'),
     (0.0, '2011-02-21'),
     (0.82, '2011-02-22'),
     (0.0, '2011-02-23'),
     (0.2, '2011-02-24'),
     (0.0, '2011-02-25'),
     (0.0, '2011-02-26'),
     (0.0, '2011-02-27'),
     (0.0, '2011-02-28'),
     (0.1, '2011-03-01'),
     (0.0, '2011-03-02'),
     (0.0, '2011-03-03'),
     (0.88, '2011-03-04'),
     (0.4, '2011-03-05'),
     (0.03, '2011-03-06'),
     (None, '2011-03-08'),
     (0.2, '2011-03-09'),
     (0.15, '2011-03-10'),
     (0.0, '2011-03-12'),
     (0.0, '2011-03-13'),
     (0.0, '2011-03-14'),
     (0.0, '2011-03-16'),
     (0.01, '2011-03-17'),
     (0.05, '2011-03-18'),
     (0.01, '2011-03-19'),
     (0.02, '2011-03-20'),
     (0.0, '2011-03-21'),
     (0.02, '2011-03-22'),
     (0.0, '2011-03-23'),
     (0.06, '2011-03-24'),
     (0.0, '2011-03-25'),
     (0.0, '2011-03-26'),
     (0.0, '2011-03-27'),
     (0.04, '2011-03-28'),
     (0.0, '2011-03-30'),
     (0.0, '2011-03-31'),
     (0.05, '2011-04-01'),
     (0.04, '2011-04-02'),
     (0.0, '2011-04-03'),
     (0.0, '2011-04-04'),
     (0.0, '2011-04-05'),
     (0.09, '2011-04-06'),
     (1.11, '2011-04-07'),
     (0.36, '2011-04-08'),
     (0.02, '2011-04-09'),
     (0.0, '2011-04-10'),
     (0.0, '2011-04-11'),
     (0.0, '2011-04-12'),
     (0.0, '2011-04-13'),
     (0.0, '2011-04-15'),
     (0.12, '2011-04-16'),
     (0.0, '2011-04-17'),
     (0.0, '2011-04-18'),
     (0.0, '2011-04-19'),
     (0.0, '2011-04-20'),
     (0.0, '2011-04-21'),
     (0.0, '2011-04-22'),
     (0.0, '2011-04-23'),
     (0.0, '2011-04-24'),
     (0.0, '2011-04-25'),
     (0.0, '2011-04-26'),
     (0.0, '2011-04-27'),
     (0.0, '2011-04-29'),
     (0.04, '2011-04-30'),
     (0.0, '2011-05-01'),
     (0.0, '2011-05-02'),
     (2.1, '2011-05-03'),
     (0.02, '2011-05-04'),
     (0.12, '2011-05-05'),
     (0.12, '2011-05-06'),
     (0.55, '2011-05-07'),
     (0.55, '2011-05-08'),
     (0.02, '2011-05-09'),
     (0.11, '2011-05-10'),
     (0.1, '2011-05-11'),
     (0.0, '2011-05-12'),
     (0.0, '2011-05-13'),
     (0.0, '2011-05-14'),
     (0.0, '2011-05-15'),
     (0.0, '2011-05-16'),
     (0.0, '2011-05-17'),
     (0.0, '2011-05-18'),
     (0.01, '2011-05-19'),
     (0.0, '2011-05-20'),
     (0.0, '2011-05-21'),
     (0.06, '2011-05-22'),
     (0.02, '2011-05-23'),
     (0.0, '2011-05-24'),
     (0.0, '2011-05-25'),
     (0.0, '2011-05-26'),
     (0.0, '2011-05-27'),
     (0.0, '2011-05-28'),
     (0.0, '2011-05-29'),
     (0.0, '2011-05-30'),
     (0.05, '2011-05-31'),
     (0.07, '2011-06-01'),
     (0.0, '2011-06-02'),
     (0.56, '2011-06-03'),
     (0.89, '2011-06-04'),
     (0.0, '2011-06-05'),
     (0.0, '2011-06-06'),
     (0.0, '2011-06-07'),
     (0.03, '2011-06-08'),
     (0.01, '2011-06-09'),
     (0.0, '2011-06-10'),
     (0.0, '2011-06-11'),
     (0.0, '2011-06-12'),
     (0.0, '2011-06-13'),
     (0.0, '2011-06-14'),
     (0.0, '2011-06-15'),
     (0.0, '2011-06-17'),
     (0.0, '2011-06-18'),
     (0.05, '2011-06-19'),
     (0.06, '2011-06-20'),
     (0.07, '2011-06-21'),
     (None, '2011-06-24'),
     (0.0, '2011-06-25'),
     (0.0, '2011-06-26'),
     (0.01, '2011-06-27'),
     (0.01, '2011-06-28'),
     (0.0, '2011-06-29'),
     (0.05, '2011-07-01'),
     (0.02, '2011-07-02'),
     (0.0, '2011-07-03'),
     (0.0, '2011-07-04'),
     (0.01, '2011-07-05'),
     (0.01, '2011-07-06'),
     (0.01, '2011-07-07'),
     (0.0, '2011-07-08'),
     (0.03, '2011-07-09'),
     (0.02, '2011-07-10'),
     (0.0, '2011-07-11'),
     (0.0, '2011-07-12'),
     (0.15, '2011-07-13'),
     (0.0, '2011-07-14'),
     (0.0, '2011-07-15'),
     (0.0, '2011-07-16'),
     (0.04, '2011-07-17'),
     (0.0, '2011-07-18'),
     (0.0, '2011-07-19'),
     (0.0, '2011-07-20'),
     (0.03, '2011-07-21'),
     (0.0, '2011-07-23'),
     (0.0, '2011-07-24'),
     (0.0, '2011-07-25'),
     (0.0, '2011-07-26'),
     (0.04, '2011-07-27'),
     (0.09, '2011-07-28'),
     (0.04, '2011-07-29'),
     (0.12, '2011-07-30'),
     (0.0, '2011-07-31'),
     (0.0, '2011-08-01'),
     (0.0, '2011-08-02'),
     (0.0, '2011-08-03'),
     (0.02, '2011-08-04'),
     (0.03, '2011-08-05'),
     (0.01, '2011-08-06'),
     (0.0, '2011-08-07'),
     (0.0, '2011-08-08'),
     (0.0, '2011-08-09'),
     (0.0, '2011-08-11'),
     (0.0, '2011-08-12'),
     (0.0, '2011-08-13'),
     (0.0, '2011-08-14'),
     (0.0, '2011-08-15'),
     (0.0, '2011-08-16'),
     (0.02, '2011-08-17'),
     (0.0, '2011-08-18'),
     (0.0, '2011-08-19'),
     (0.07, '2011-08-20'),
     (0.0, '2011-08-21'),
     (0.0, '2011-08-22'),
     (0.0, '2011-08-23'),
     (0.0, '2011-08-24'),
     (0.0, '2011-08-25'),
     (0.0, '2011-08-26'),
     (0.0, '2011-08-27'),
     (0.05, '2011-08-28'),
     (0.1, '2011-08-29'),
     (0.02, '2011-08-30'),
     (0.0, '2011-08-31'),
     (0.0, '2011-09-02'),
     (0.0, '2011-09-03'),
     (0.03, '2011-09-04'),
     (0.0, '2011-09-05'),
     (0.0, '2011-09-06'),
     (0.0, '2011-09-07'),
     (0.0, '2011-09-08'),
     (0.0, '2011-09-09'),
     (0.0, '2011-09-10'),
     (0.0, '2011-09-11'),
     (0.0, '2011-09-12'),
     (0.01, '2011-09-13'),
     (0.0, '2011-09-14'),
     (0.0, '2011-09-15'),
     (0.0, '2011-09-16'),
     (0.02, '2011-09-17'),
     (0.04, '2011-09-18'),
     (0.0, '2011-09-19'),
     (0.0, '2011-09-20'),
     (0.0, '2011-09-21'),
     (0.03, '2011-09-22'),
     (0.0, '2011-09-23'),
     (0.0, '2011-09-24'),
     (0.0, '2011-09-25'),
     (0.0, '2011-09-26'),
     (0.0, '2011-09-27'),
     (0.0, '2011-09-28'),
     (0.0, '2011-10-01'),
     (0.0, '2011-10-02'),
     (0.0, '2011-10-03'),
     (None, '2011-10-05'),
     (0.0, '2011-10-06'),
     (0.03, '2011-10-07'),
     (0.0, '2011-10-08'),
     (0.0, '2011-10-09'),
     (0.02, '2011-10-10'),
     (0.03, '2011-10-11'),
     (0.0, '2011-10-12'),
     (0.0, '2011-10-13'),
     (0.03, '2011-10-14'),
     (0.02, '2011-10-15'),
     (0.0, '2011-10-16'),
     (0.02, '2011-10-17'),
     (0.01, '2011-10-18'),
     (0.0, '2011-10-19'),
     (0.0, '2011-10-20'),
     (0.0, '2011-10-21'),
     (0.0, '2011-10-22'),
     (0.0, '2011-10-23'),
     (0.14, '2011-10-24'),
     (1.6, '2011-10-25'),
     (0.01, '2011-10-26'),
     (0.0, '2011-10-27'),
     (0.05, '2011-10-28'),
     (0.01, '2011-10-29'),
     (0.0, '2011-10-30'),
     (0.03, '2011-10-31'),
     (0.58, '2011-11-01'),
     (0.28, '2011-11-02'),
     (0.02, '2011-11-03'),
     (0.01, '2011-11-04'),
     (0.0, '2011-11-05'),
     (0.0, '2011-11-06'),
     (0.0, '2011-11-07'),
     (0.0, '2011-11-08'),
     (0.02, '2011-11-09'),
     (0.0, '2011-11-10'),
     (0.05, '2011-11-11'),
     (0.0, '2011-11-12'),
     (0.0, '2011-11-13'),
     (0.0, '2011-11-14'),
     (0.0, '2011-11-15'),
     (0.0, '2011-11-16'),
     (0.0, '2011-11-17'),
     (0.0, '2011-11-18'),
     (0.0, '2011-11-19'),
     (0.0, '2011-11-20'),
     (0.01, '2011-11-21'),
     (0.02, '2011-11-22'),
     (0.01, '2011-11-23'),
     (0.0, '2011-11-24'),
     (0.01, '2011-11-25'),
     (0.02, '2011-11-26'),
     (0.07, '2011-11-27'),
     (0.0, '2011-11-28'),
     (0.0, '2011-11-29'),
     (0.02, '2011-11-30'),
     (0.03, '2011-12-01'),
     (0.08, '2011-12-02'),
     (0.0, '2011-12-03'),
     (0.0, '2011-12-04'),
     (0.0, '2011-12-05'),
     (0.0, '2011-12-06'),
     (0.0, '2011-12-07'),
     (0.0, '2011-12-08'),
     (0.13, '2011-12-09'),
     (0.07, '2011-12-10'),
     (0.07, '2011-12-11'),
     (0.08, '2011-12-12'),
     (0.4, '2011-12-13'),
     (0.7, '2011-12-14'),
     (0.0, '2011-12-15'),
     (0.01, '2011-12-16'),
     (0.07, '2011-12-17'),
     (0.02, '2011-12-18'),
     (0.15, '2011-12-19'),
     (0.02, '2011-12-20'),
     (0.18, '2011-12-21'),
     (0.03, '2011-12-22'),
     (0.04, '2011-12-23'),
     (0.1, '2011-12-24'),
     (0.03, '2011-12-25'),
     (0.0, '2011-12-26'),
     (0.0, '2011-12-27'),
     (0.0, '2011-12-28'),
     (0.0, '2011-12-29'),
     (0.0, '2011-12-30'),
     (0.01, '2011-12-31'),
     (0.0, '2012-01-01'),
     (0.0, '2012-01-02'),
     (0.0, '2012-01-03'),
     (0.0, '2012-01-04'),
     (0.0, '2012-01-06'),
     (0.0, '2012-01-07'),
     (0.0, '2012-01-08'),
     (0.0, '2012-01-10'),
     (0.0, '2012-01-11'),
     (0.0, '2012-01-12'),
     (0.0, '2012-01-14'),
     (0.0, '2012-01-15'),
     (0.04, '2012-01-16'),
     (0.0, '2012-01-17'),
     (0.0, '2012-01-18'),
     (0.02, '2012-01-19'),
     (0.0, '2012-01-20'),
     (0.0, '2012-01-21'),
     (0.0, '2012-01-22'),
     (0.0, '2012-01-23'),
     (0.0, '2012-01-24'),
     (0.0, '2012-01-25'),
     (0.0, '2012-01-26'),
     (0.04, '2012-01-27'),
     (0.03, '2012-01-28'),
     (1.03, '2012-01-29'),
     (0.01, '2012-01-30'),
     (0.0, '2012-01-31'),
     (0.0, '2012-02-01'),
     (0.0, '2012-02-02'),
     (0.0, '2012-02-03'),
     (0.0, '2012-02-04'),
     (0.0, '2012-02-05'),
     (0.0, '2012-02-06'),
     (0.37, '2012-02-07'),
     (0.28, '2012-02-08'),
     (0.01, '2012-02-09'),
     (0.0, '2012-02-10'),
     (0.0, '2012-02-11'),
     (0.0, '2012-02-12'),
     (0.04, '2012-02-13'),
     (0.01, '2012-02-14'),
     (0.0, '2012-02-15'),
     (0.0, '2012-02-16'),
     (0.0, '2012-02-17'),
     (0.04, '2012-02-18'),
     (0.01, '2012-02-19'),
     (0.0, '2012-02-20'),
     (0.0, '2012-02-21'),
     (0.0, '2012-02-22'),
     (0.0, '2012-02-23'),
     (0.0, '2012-02-24'),
     (0.0, '2012-02-25'),
     (0.05, '2012-02-26'),
     (0.06, '2012-02-27'),
     (0.0, '2012-02-28'),
     (0.0, '2012-02-29'),
     (0.06, '2012-03-01'),
     (0.0, '2012-03-02'),
     (0.03, '2012-03-03'),
     (0.01, '2012-03-04'),
     (1.08, '2012-03-05'),
     (4.0, '2012-03-06'),
     (2.42, '2012-03-07'),
     (0.02, '2012-03-08'),
     (0.19, '2012-03-09'),
     (0.06, '2012-03-10'),
     (0.0, '2012-03-11'),
     (0.03, '2012-03-12'),
     (0.0, '2012-03-13'),
     (0.0, '2012-03-14'),
     (0.0, '2012-03-15'),
     (0.05, '2012-03-16'),
     (0.0, '2012-03-17'),
     (0.0, '2012-03-18'),
     (0.0, '2012-03-19'),
     (0.0, '2012-03-20'),
     (0.0, '2012-03-21'),
     (0.03, '2012-03-22'),
     (0.01, '2012-03-23'),
     (0.0, '2012-03-24'),
     (0.0, '2012-03-25'),
     (0.11, '2012-03-26'),
     (0.03, '2012-03-27'),
     (0.02, '2012-03-28'),
     (0.0, '2012-03-29'),
     (0.0, '2012-03-30'),
     (0.0, '2012-03-31'),
     (0.0, '2012-04-01'),
     (0.0, '2012-04-02'),
     (0.0, '2012-04-03'),
     (0.0, '2012-04-04'),
     (0.19, '2012-04-05'),
     (0.0, '2012-04-06'),
     (0.03, '2012-04-07'),
     (0.0, '2012-04-08'),
     (0.07, '2012-04-09'),
     (0.05, '2012-04-10'),
     (0.06, '2012-04-11'),
     (0.0, '2012-04-12'),
     (0.03, '2012-04-13'),
     (0.0, '2012-04-14'),
     (0.01, '2012-04-15'),
     (0.01, '2012-04-16'),
     (0.0, '2012-04-17'),
     (0.0, '2012-04-18'),
     (0.0, '2012-04-19'),
     (0.0, '2012-04-20'),
     (0.01, '2012-04-21'),
     (0.04, '2012-04-22'),
     (0.03, '2012-04-23'),
     (0.0, '2012-04-24'),
     (0.0, '2012-04-25'),
     (0.0, '2012-04-26'),
     (0.0, '2012-04-27'),
     (0.0, '2012-04-28'),
     (0.0, '2012-04-29'),
     (0.0, '2012-04-30'),
     (0.0, '2012-05-01'),
     (0.0, '2012-05-02'),
     (0.0, '2012-05-03'),
     (0.0, '2012-05-04'),
     (0.04, '2012-05-05'),
     (0.0, '2012-05-06'),
     (0.0, '2012-05-07'),
     (0.0, '2012-05-08'),
     (0.0, '2012-05-09'),
     (0.0, '2012-05-10'),
     (0.0, '2012-05-11'),
     (0.0, '2012-05-12'),
     (0.0, '2012-05-13'),
     (0.0, '2012-05-14'),
     (0.0, '2012-05-15'),
     (0.0, '2012-05-16'),
     (0.0, '2012-05-17'),
     (0.0, '2012-05-18'),
     (0.0, '2012-05-19'),
     (0.0, '2012-05-20'),
     (0.0, '2012-05-21'),
     (0.0, '2012-05-22'),
     (0.0, '2012-05-23'),
     (0.0, '2012-05-24'),
     (0.0, '2012-05-25'),
     (0.0, '2012-05-26'),
     (0.0, '2012-05-27'),
     (0.0, '2012-05-28'),
     (0.0, '2012-05-29'),
     (0.0, '2012-05-30'),
     (0.01, '2012-05-31'),
     (0.02, '2012-06-01'),
     (0.02, '2012-06-02'),
     (0.0, '2012-06-03'),
     (0.0, '2012-06-04'),
     (0.0, '2012-06-05'),
     (0.0, '2012-06-06'),
     (0.0, '2012-06-07'),
     (None, '2012-06-08'),
     (None, '2012-06-09'),
     (0.0, '2012-06-10'),
     (0.0, '2012-06-11'),
     (0.0, '2012-06-12'),
     (0.0, '2012-06-13'),
     (0.0, '2012-06-14'),
     (0.0, '2012-06-15'),
     (0.0, '2012-06-16'),
     (0.0, '2012-06-17'),
     (0.0, '2012-06-18'),
     (0.0, '2012-06-19'),
     (0.0, '2012-06-20'),
     (0.0, '2012-06-21'),
     (0.0, '2012-06-22'),
     (0.0, '2012-06-23'),
     (0.0, '2012-06-24'),
     (0.03, '2012-06-25'),
     (0.15, '2012-06-26'),
     (0.01, '2012-06-27'),
     (0.0, '2012-06-28'),
     (0.05, '2012-06-29'),
     (0.0, '2012-06-30'),
     (0.0, '2012-07-01'),
     (0.0, '2012-07-02'),
     (0.04, '2012-07-03'),
     (0.01, '2012-07-04'),
     (0.03, '2012-07-05'),
     (0.0, '2012-07-06'),
     (0.04, '2012-07-07'),
     (0.0, '2012-07-08'),
     (None, '2012-07-09'),
     (0.0, '2012-07-10'),
     (0.0, '2012-07-11'),
     (0.0, '2012-07-12'),
     (0.0, '2012-07-13'),
     (0.0, '2012-07-14'),
     (0.0, '2012-07-15'),
     (0.01, '2012-07-16'),
     (0.0, '2012-07-17'),
     (0.0, '2012-07-18'),
     (0.0, '2012-07-19'),
     (0.0, '2012-07-20'),
     (0.0, '2012-07-21'),
     (0.0, '2012-07-22'),
     (0.0, '2012-07-23'),
     (0.0, '2012-07-24'),
     (0.0, '2012-07-25'),
     (0.02, '2012-07-26'),
     (0.0, '2012-07-27'),
     (0.0, '2012-07-28'),
     (0.01, '2012-07-29'),
     (0.01, '2012-07-30'),
     (0.0, '2012-07-31'),
     (0.0, '2012-08-01'),
     (0.0, '2012-08-02'),
     (0.0, '2012-08-03'),
     (0.0, '2012-08-04'),
     (0.0, '2012-08-05'),
     (0.0, '2012-08-06'),
     (0.0, '2012-08-07'),
     (0.02, '2012-08-08'),
     (0.0, '2012-08-09'),
     (0.0, '2012-08-10'),
     (0.0, '2012-08-11'),
     (0.0, '2012-08-12'),
     (0.0, '2012-08-13'),
     (0.0, '2012-08-14'),
     (0.01, '2012-08-15'),
     (0.0, '2012-08-16'),
     (0.0, '2012-08-17'),
     (None, '2012-08-18'),
     (None, '2012-08-19'),
     (0.0, '2012-08-20'),
     (0.0, '2012-08-21'),
     (0.03, '2012-08-22'),
     (0.0, '2012-08-23'),
     (0.0, '2012-08-24'),
     (0.0, '2012-08-25'),
     (0.0, '2012-08-26'),
     (0.02, '2012-08-27'),
     (1.0, '2012-08-28'),
     (0.02, '2012-08-29'),
     (0.04, '2012-08-30'),
     (0.0, '2012-08-31'),
     (0.01, '2012-09-01'),
     (0.04, '2012-09-02'),
     (0.06, '2012-09-03'),
     (0.0, '2012-09-04'),
     (0.01, '2012-09-05'),
     (0.04, '2012-09-06'),
     (0.0, '2012-09-07'),
     (0.06, '2012-09-08'),
     (0.0, '2012-09-09'),
     (0.0, '2012-09-10'),
     (0.0, '2012-09-11'),
     (0.02, '2012-09-12'),
     (0.05, '2012-09-13'),
     (0.04, '2012-09-14'),
     (0.0, '2012-09-15'),
     (0.0, '2012-09-16'),
     (0.0, '2012-09-17'),
     (0.06, '2012-09-18'),
     (0.0, '2012-09-19'),
     (0.07, '2012-09-20'),
     (0.08, '2012-09-21'),
     (0.0, '2012-09-22'),
     (0.04, '2012-09-23'),
     (0.0, '2012-09-24'),
     (0.0, '2012-09-25'),
     (0.01, '2012-09-26'),
     (0.02, '2012-09-27'),
     (0.0, '2012-09-28'),
     (0.0, '2012-09-29'),
     (0.02, '2012-09-30'),
     (0.0, '2012-10-01'),
     (0.0, '2012-10-02'),
     (0.0, '2012-10-03'),
     (0.0, '2012-10-04'),
     (0.0, '2012-10-05'),
     (0.03, '2012-10-06'),
     (0.0, '2012-10-07'),
     (0.0, '2012-10-08'),
     (0.0, '2012-10-09'),
     (0.0, '2012-10-10'),
     (0.0, '2012-10-11'),
     (0.0, '2012-10-12'),
     (0.0, '2012-10-13'),
     (0.0, '2012-10-14'),
     (0.02, '2012-10-15'),
     (0.0, '2012-10-16'),
     (0.0, '2012-10-17'),
     (0.0, '2012-10-18'),
     (0.0, '2012-10-19'),
     (0.0, '2012-10-20'),
     (0.0, '2012-10-21'),
     (0.0, '2012-10-22'),
     (0.0, '2012-10-23'),
     (0.0, '2012-10-24'),
     (0.0, '2012-10-25'),
     (0.0, '2012-10-26'),
     (0.0, '2012-10-27'),
     (0.02, '2012-10-28'),
     (0.04, '2012-10-29'),
     (0.0, '2012-10-30'),
     (0.02, '2012-10-31'),
     (0.0, '2012-11-01'),
     (0.0, '2012-11-02'),
     (0.0, '2012-11-03'),
     (0.0, '2012-11-04'),
     (0.0, '2012-11-05'),
     (0.0, '2012-11-06'),
     (0.0, '2012-11-07'),
     (0.0, '2012-11-08'),
     (0.03, '2012-11-09'),
     (0.0, '2012-11-10'),
     (0.0, '2012-11-11'),
     (0.0, '2012-11-12'),
     (0.06, '2012-11-13'),
     (0.0, '2012-11-14'),
     (0.08, '2012-11-15'),
     (0.03, '2012-11-16'),
     (0.01, '2012-11-17'),
     (0.03, '2012-11-18'),
     (0.0, '2012-11-19'),
     (0.0, '2012-11-20'),
     (0.0, '2012-11-21'),
     (0.0, '2012-11-22'),
     (0.0, '2012-11-23'),
     (0.02, '2012-11-24'),
     ...]




```python
session.query(Hawaii.prcp,Hawaii.date).filter(Hawaii.date > last_year).sum()
```


    ---------------------------------------------------------------------------

    AttributeError                            Traceback (most recent call last)

    <ipython-input-33-b1958ef8c720> in <module>()
    ----> 1 session.query(Hawaii.prcp,Hawaii.date).filter(Hawaii.date > last_year).sum()
    

    AttributeError: 'Query' object has no attribute 'sum'


#timedelta gives you time frame, not time object(allows you to manipulate time, string but it's actually an object
dt.timedelta: libary that gives you a time range, but not landing on specific time



```python
dt.date.today() 
#datetime object 
```


```python
dt.timedelta()
```


```python
#DATE_SUB(NOW(),INTERVAL 1 YEAR)
```


```python
DATE_FORMAT(create_date, '%m/%d/%Y')

date = DATE_FORMAT(date, '%Y-%m-%d') #becomes datetime object so we can do subinterval
```


```python
conn.execute('''select prcp, DATE_FORMAT(date, '%Y-%m-%d') FROM Hawaii where date > date BETWEEN CURDATE() - INTERVAL 365 DAY AND CURDATE() ''')

```


    ---------------------------------------------------------------------------

    OperationalError                          Traceback (most recent call last)

    ~/anaconda3/lib/python3.6/site-packages/sqlalchemy/engine/base.py in _execute_context(self, dialect, constructor, statement, parameters, *args)
       1192                         parameters,
    -> 1193                         context)
       1194         except BaseException as e:


    ~/anaconda3/lib/python3.6/site-packages/sqlalchemy/engine/default.py in do_execute(self, cursor, statement, parameters, context)
        506     def do_execute(self, cursor, statement, parameters, context=None):
    --> 507         cursor.execute(statement, parameters)
        508 


    OperationalError: near "365": syntax error

    
    The above exception was the direct cause of the following exception:


    OperationalError                          Traceback (most recent call last)

    <ipython-input-27-891db22e6f83> in <module>()
    ----> 1 conn.execute('''select prcp, DATE_FORMAT(date, '%Y-%m-%d') FROM Hawaii where date > date BETWEEN CURDATE() - INTERVAL 365 DAY AND CURDATE() ''')
    

    ~/anaconda3/lib/python3.6/site-packages/sqlalchemy/engine/base.py in execute(self, object, *multiparams, **params)
        940         """
        941         if isinstance(object, util.string_types[0]):
    --> 942             return self._execute_text(object, multiparams, params)
        943         try:
        944             meth = object._execute_on_connection


    ~/anaconda3/lib/python3.6/site-packages/sqlalchemy/engine/base.py in _execute_text(self, statement, multiparams, params)
       1102             statement,
       1103             parameters,
    -> 1104             statement, parameters
       1105         )
       1106         if self._has_events or self.engine._has_events:


    ~/anaconda3/lib/python3.6/site-packages/sqlalchemy/engine/base.py in _execute_context(self, dialect, constructor, statement, parameters, *args)
       1198                 parameters,
       1199                 cursor,
    -> 1200                 context)
       1201 
       1202         if self._has_events or self.engine._has_events:


    ~/anaconda3/lib/python3.6/site-packages/sqlalchemy/engine/base.py in _handle_dbapi_exception(self, e, statement, parameters, cursor, context)
       1411                 util.raise_from_cause(
       1412                     sqlalchemy_exception,
    -> 1413                     exc_info
       1414                 )
       1415             else:


    ~/anaconda3/lib/python3.6/site-packages/sqlalchemy/util/compat.py in raise_from_cause(exception, exc_info)
        201     exc_type, exc_value, exc_tb = exc_info
        202     cause = exc_value if exc_value is not exception else None
    --> 203     reraise(type(exception), exception, tb=exc_tb, cause=cause)
        204 
        205 if py3k:


    ~/anaconda3/lib/python3.6/site-packages/sqlalchemy/util/compat.py in reraise(tp, value, tb, cause)
        184             value.__cause__ = cause
        185         if value.__traceback__ is not tb:
    --> 186             raise value.with_traceback(tb)
        187         raise value
        188 


    ~/anaconda3/lib/python3.6/site-packages/sqlalchemy/engine/base.py in _execute_context(self, dialect, constructor, statement, parameters, *args)
       1191                         statement,
       1192                         parameters,
    -> 1193                         context)
       1194         except BaseException as e:
       1195             self._handle_dbapi_exception(


    ~/anaconda3/lib/python3.6/site-packages/sqlalchemy/engine/default.py in do_execute(self, cursor, statement, parameters, context)
        505 
        506     def do_execute(self, cursor, statement, parameters, context=None):
    --> 507         cursor.execute(statement, parameters)
        508 
        509     def do_execute_no_params(self, cursor, statement, context=None):


    OperationalError: (sqlite3.OperationalError) near "365": syntax error [SQL: "select prcp, DATE_FORMAT(date, '%Y-%m-%d') FROM Hawaii where date > date BETWEEN CURDATE() - INTERVAL 365 DAY AND CURDATE() "] (Background on this error at: http://sqlalche.me/e/e3q8)



```python
conn.execute('''SHOW columns from Hawaii''').fetchall()
```
